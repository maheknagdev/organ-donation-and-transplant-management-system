{% extends 'core/base.html' %}
{% block title %}Allocations{% endblock %}
{% block content %}
<style>
    .back-link { color: #667eea; text-decoration: none; margin-bottom: 20px; display: inline-block; }
    table { width: 100%; border-collapse: collapse; background: white; }
    th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
    th { background: #667eea; color: white; }
    tr:hover { background: #f5f5f5; }
    .badge { padding: 5px 10px; border-radius: 12px; font-size: 0.85em; }
    .badge-pending { background: #fff3cd; color: #856404; }
    .badge-accepted { background: #d4edda; color: #155724; }
    .badge-rejected { background: #f8d7da; color: #721c24; }
</style>

{% if messages %}
    {% for message in messages %}
        <div style="padding: 15px; background: #d4edda; color: #155724; border-radius: 5px; margin-bottom: 20px;">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}

<h2>ðŸ“‹ Organ Allocations</h2>
<p style="color: #666; margin-bottom: 20px;">All allocation offers and responses</p>

<table>
    <thead>
        <tr>
            <th>Allocation ID</th>
            <th>Organ</th>
            <th>Recipient</th>
            <th>Match Score</th>
            <th>Allocation Date</th>
            <th>Deadline</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for allocation in allocations %}
        <tr>
            <td>{{ allocation.allocation_id }}</td>
            <td>{{ allocation.organ.type_name.type_name }} #{{ allocation.organ.organ_id }}</td>
            <td>{{ allocation.recipient.name }}</td>
            <td><strong>{{ allocation.match_score }}</strong></td>
            <td>{{ allocation.allocation_date|date:"M d, Y H:i" }}</td>
            <td>{{ allocation.response_deadline|date:"M d, Y H:i" }}</td>
            <td>
                <span class="badge badge-{{ allocation.status|lower }}">{{ allocation.status }}</span>
            </td>
            <td>
                {% if allocation.status == 'Pending' %}
                <a href="{% url 'core:respond_to_allocation' allocation.allocation_id %}" style="color: #667eea;">Respond</a>
                {% else %}
                -
                {% endif %}
            </td>
        </tr>
        {% empty %}
        <tr><td colspan="8" style="text-align: center; padding: 40px;">No allocations yet</td></tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}